<div class="">
    <div class="">
        <h2>
            Solicitudes de reconocimiento de producción intelectual
        </h2>
    </div>
    @if (this.applications.length > 0) {
    <p-table #dt1 [value]="applications" [paginator]="true" [rows]="5" [first]="first" [showCurrentPageReport]="true"
        [tableStyle]="{ 'min-width': '50rem' }" selectionMode="single" dataKey="id" [globalFilterFields]="['applicationId', 'applicationTypeCatId', 'production.productionType.name', 
        'createAt','applicationStatus.name']"
        currentPageReportTemplate="Mostrando {first} - {last} de {totalRecords} solicitudes"
        (onPage)="pageChange($event)" [rowsPerPageOptions]="[5, 10, 15, 20, 25]" dataKey="id">
        <ng-template #caption>
            <p-iconfield iconPosition="left">
                <p-inputicon>
                    <i class="pi pi-search"></i>
                </p-inputicon>
                <input pInputText type="text" [ngStyle]="{ 'width': '70%' }" (input)="search($event)"
                    placeholder="Buscar..." />
            </p-iconfield>
        </ng-template>
        <ng-template #header>
            <tr>
                <th class="text-primary" pSortableColumn="applicationId">
                    Id <p-sortIcon field="applicationId" />
                </th>
                <th class="text-primary" pSortableColumn="production.workTitle">
                    Título <p-sortIcon field="production.workTitle" />
                </th>
                <th class="text-primary" pSortableColumn="nombresSolicitante">
                    Solicitante <p-sortIcon field="nombresSolicitante" />
                </th>
                <th class="text-primary" pSortableColumn="applicationTypeName">
                    Reconocimiento <p-sortIcon field="applicationTypeName" />
                </th>
                <th class="text-primary" pSortableColumn="production.productionType.name">
                    Tipo producción <p-sortIcon field="production.productionType.name" />
                </th>
                <th class="text-primary" pSortableColumn="createAt">
                    Fecha de envío <p-sortIcon field="createAt" />
                </th>
                <th class="text-primary" pSortableColumn="department">
                    Facultad <p-sortIcon field="department" />
                </th>
                <th class="text-primary" pSortableColumn="applicationStatus.name">
                    Estado <p-sortIcon field="applicationStatus.name" />
                </th>
                <th class="text-primary">Acciones</th>
            </tr>
        </ng-template>
        <ng-template #body let-application>
            <tr>
                <td>{{ application.applicationId }}</td>
                <td>{{ application.production.workTitle }}</td>
                <td>{{ application.nombresSolicitante }}</td>
                <td>{{ application.applicationTypeName }}</td>
                <td>{{ application.production.productionType.name }}</td>
                <td>{{ application.ciarpSendDate | date: 'dd/MM/yyyy HH:mm' }}</td>
                <td>{{ application.department.faculty.name }}</td>
                <td>{{ application.applicationStatus.name }}</td>
                <td>
                    <div class="flex justify-between">
                        @if (application.applicationStatus.name === ApplicationStatus.SEND_TO_CIARP) {
                        <button pButton pRipple icon="pi pi-file-check" class="p-button-rounded p-button-text"
                            [routerLink]="['../revisar-solicitud', application.applicationId]">
                            Revisar
                        </button>
                        }
                        @if (application.applicationStatus.name === ApplicationStatus.REVIEWED_BY_CIARP_SECRETARY) {
                        <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Ver detalle
                        </button>
                        <button pButton pRipple icon="pi pi-check-square" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Avalar
                        </button>
                        }
                        @if (application.applicationStatus.name === ApplicationStatus.REVIEWED_BY_CIARP_MEMBER) {
                        <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Ver detalle
                        </button>
                        <button pButton pRipple icon="pi pi-check-square" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Avalar
                        </button>
                        }
                        @if (application.applicationStatus.name === ApplicationStatus.RETURNED_IN_CIARP) {
                        <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Ver detalle
                        </button>
                        }
                        @if (application.applicationStatus.name === ApplicationStatus.REJECTED_CIARP) {
                        <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Ver detalle
                        </button>
                        }
                        @if (application.applicationStatus.name === ApplicationStatus.ENDORSED_CIARP) {
                        <button pButton pRipple icon="pi pi-eye" class="p-button-rounded p-button-text"
                            [routerLink]="['../ver-detalle-solicitud', application.applicationId]">
                            Ver detalle
                        </button>
                        <button pButton pRipple icon="pi pi-bell" class="p-button-rounded p-button-text"
                            [routerLink]="['../crear-resolucion', application.applicationId]">
                            Notificar
                        </button>
                        }
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
    }
    <!-- Dialog alert -->
    <p-toast />
    <p-confirmdialog />
</div>