import { CommonModule } from '@angular/common';
import { Component, inject } from '@angular/core';
import { FormsModule } from '@angular/forms';
import { RouterModule } from '@angular/router';
import { ConfirmationService, MessageService } from 'primeng/api';
import { ButtonModule } from 'primeng/button';
import { ConfirmDialogModule } from 'primeng/confirmdialog';
import { Editor } from 'primeng/editor';
import { ToastModule } from 'primeng/toast';

@Component({
  selector: 'app-create-certificate',
  imports: [CommonModule, FormsModule, RouterModule, ButtonModule, RouterModule, 
    ToastModule, ConfirmDialogModule, Editor],
  providers: [ConfirmationService, MessageService],
  templateUrl: './create-certificate.component.html',
  styleUrl: './create-certificate.component.css'
})
export class CreateCertificateComponent {

  text: string | undefined;

  private readonly confirmationService = inject(ConfirmationService);
  private readonly messageService = inject(MessageService);

  constructor() { }

  ngOnInit(): void {
    this.text = `
    <table style="border: 1px solid #000;"><tbody><tr><td data-row="1"><strong style="color: windowtext;">Ciudad</strong></td><td data-row="1" class="ql-align-center"><strong>Popayán</strong></td><td data-row="1" class="ql-align-center"><strong>Dependencia(s)&nbsp;responsable&nbsp;(s)&nbsp;de&nbsp;la&nbsp;actividad</strong></td><td data-row="1" class="ql-align-center"></td><td data-row="1" class="ql-align-center">Comité&nbsp;de&nbsp;Personal&nbsp;Docente&nbsp;–&nbsp;FIET</td><td data-row="1" class="ql-align-center"><strong>8.4.3-35.3</strong></td><td data-row="1" class="ql-align-center">Sesión&nbsp;Ordinaria</td></tr><tr><td data-row="2" class="ql-align-center"><strong>Fecha</strong></td><td data-row="2" class="ql-align-center">12</td><td data-row="2" class="ql-align-center">04</td><td data-row="2" class="ql-align-center">2018</td><td data-row="2" class="ql-align-center"><strong>Hora&nbsp;Inicio</strong></td><td data-row="2" class="ql-align-center"><strong>Hora&nbsp;Finalización</strong></td><td data-row="2" class="ql-align-center"><strong>Lugar&nbsp;de&nbsp;desarrollo</strong></td><td data-row="2" class="ql-align-center"><strong>ACTA</strong></td><td data-row="2" class="ql-align-center"><strong>No</strong></td></tr><tr><td data-row="3" class="ql-align-center"></td><td data-row="3" class="ql-align-center">9:00&nbsp;a.m.</td><td data-row="3" class="ql-align-center"></td><td data-row="3" class="ql-align-center">11:00&nbsp;a.m.</td><td data-row="3" class="ql-align-center">Sala&nbsp;Consejo&nbsp;FIET&nbsp;</td><td data-row="3" class="ql-align-center">014</td></tr></tbody></table><p></p><p><strong>ORDEN&nbsp;DEL&nbsp;DIA</strong></p><ol><li><strong>Verificación&nbsp;de&nbsp;Asistencia</strong></li><li><strong>Lectura&nbsp;de&nbsp;acta&nbsp;anterior&nbsp;SI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO&nbsp;</strong></li><li><strong>Temas&nbsp;a&nbsp;tratar</strong></li></ol><p></p><p></p><table style="border: 1px solid #000;"><tbody><tr><td data-row="1" class="ql-align-center"><strong>No</strong></td><td data-row="1" class="ql-align-center"><strong>TEMAS&nbsp;A&nbsp;TRATAR</strong></td></tr><tr><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-justify"></td></tr><tr><td data-row="3" class="ql-align-center">2</td><td data-row="3" class="ql-align-justify">Solicitudes&nbsp;de&nbsp;reconocimiento&nbsp;de&nbsp;puntos&nbsp;salariales&nbsp;presentadas&nbsp;por&nbsp;el&nbsp;profesor&nbsp;V.</td></tr><tr><td data-row="4" class="ql-align-center">3</td><td data-row="4" class="ql-align-justify">Solicitud&nbsp;de&nbsp;reconocimiento&nbsp;de&nbsp;puntos&nbsp;salariales&nbsp;presentada&nbsp;por&nbsp;el&nbsp;profesor&nbsp;O.</td></tr><tr><td data-row="5" class="ql-align-center">4</td><td data-row="5" class="ql-align-justify">Solicitud&nbsp;de&nbsp;reconocimiento&nbsp;de&nbsp;puntos&nbsp;salariales&nbsp;presentada&nbsp;por&nbsp;la&nbsp;profesora&nbsp;S.</td></tr></tbody></table><p></p><p></p><p><strong>DESARROLLO&nbsp;DE&nbsp;LA&nbsp;REUNIÓN</strong></p><p></p><table style="border: 1px solid #000;"><tbody><tr><td data-row="1" class="ql-align-center">1</td><td data-row="1" class="ql-align-justify">Después&nbsp;de&nbsp;analizar&nbsp;la&nbsp;solicitud&nbsp;presentada&nbsp;por&nbsp;la&nbsp;profesora&nbsp;Sandra&nbsp;Milena&nbsp;Roa&nbsp;Martinez,&nbsp;previamente&nbsp;avalada&nbsp;por&nbsp;el&nbsp;Departamento&nbsp;de&nbsp;Sistemas&nbsp;según&nbsp;oficio&nbsp;8.4.8/017&nbsp;de&nbsp;2018,&nbsp;y&nbsp;verificar&nbsp;el&nbsp;cumplimiento&nbsp;de&nbsp;todos&nbsp;los&nbsp;requisitos&nbsp;exigidos,&nbsp;el&nbsp;CPD&nbsp;decide&nbsp;recomendar&nbsp;al&nbsp;Consejo&nbsp;de&nbsp;Facultad&nbsp;autorizar&nbsp;los&nbsp;trámites&nbsp;necesarios&nbsp;para&nbsp;la&nbsp;aprobación&nbsp;de&nbsp;la&nbsp;prórroga&nbsp;de&nbsp;comisión&nbsp;de&nbsp;estudios&nbsp;para&nbsp;que&nbsp;la&nbsp;profesora&nbsp;continúe&nbsp;el&nbsp;cuarto&nbsp;y&nbsp;último&nbsp;año&nbsp;de&nbsp;estudios&nbsp;en&nbsp;el&nbsp;Doctorado&nbsp;en&nbsp;Ciencias&nbsp;de&nbsp;la&nbsp;Información&nbsp;de&nbsp;la&nbsp;Universidad&nbsp;Estadual&nbsp;Paulista&nbsp;de&nbsp;Brasil,&nbsp;durante&nbsp;el&nbsp;periodo&nbsp;comprendido&nbsp;entre&nbsp;el&nbsp;20&nbsp;de&nbsp;julio&nbsp;de&nbsp;2018&nbsp;y&nbsp;el&nbsp;19&nbsp;de&nbsp;julio&nbsp;de&nbsp;2019.</td><td data-row="1" class="ql-align-justify">Para&nbsp;tal&nbsp;fin&nbsp;se&nbsp;adjunta&nbsp;el&nbsp;Formato&nbsp;PM-FO-4-FOR-19,&nbsp;copia&nbsp;de&nbsp;la&nbsp;Resolución&nbsp;8.4.3-90.2/065&nbsp;de&nbsp;Experiencia&nbsp;calificada&nbsp;año&nbsp;2017,&nbsp;Aval&nbsp;del&nbsp;Departamento&nbsp;de&nbsp;Sistemas&nbsp;según&nbsp;oficio&nbsp;8.4.8/018,&nbsp;copia&nbsp;del&nbsp;Acta&nbsp;de&nbsp;Reunión&nbsp;de&nbsp;Departamento&nbsp;No.12&nbsp;del&nbsp;4&nbsp;de&nbsp;abril&nbsp;de&nbsp;2018,&nbsp;solicitud&nbsp;de&nbsp;la&nbsp;profesora&nbsp;Sandra&nbsp;Milena&nbsp;Roa&nbsp;según&nbsp;oficio&nbsp;001&nbsp;de&nbsp;2018,&nbsp;Informe&nbsp;de&nbsp;actividades&nbsp;desarrolladas&nbsp;en&nbsp;el&nbsp;tercer&nbsp;año,&nbsp;constancia&nbsp;de&nbsp;matrícula,&nbsp;comprobantes&nbsp;de&nbsp;histórico&nbsp;escolar&nbsp;y&nbsp;plan&nbsp;de&nbsp;trabajo&nbsp;para&nbsp;el&nbsp;cuarto&nbsp;año&nbsp;de&nbsp;comisión&nbsp;de&nbsp;estudios.</td><td data-row="1" class="ql-align-justify"></td></tr><tr><td data-row="2" class="ql-align-center">2</td><td data-row="2" class="ql-align-justify">Después&nbsp;de&nbsp;revisar&nbsp;las&nbsp;solicitudes&nbsp;de&nbsp;reconocimiento&nbsp;de&nbsp;puntos&nbsp;salariales&nbsp;presentadas&nbsp;por&nbsp;el&nbsp;profesor&nbsp;Victor&nbsp;Manuel&nbsp;Quintero&nbsp;Florez,&nbsp;por&nbsp;la&nbsp;publicación&nbsp;de&nbsp;los&nbsp;artículos&nbsp;relacionados&nbsp;a&nbsp;continuación,&nbsp;el&nbsp;CPD&nbsp;decidió&nbsp;recomendar&nbsp;su&nbsp;reconocimiento&nbsp;al&nbsp;tenor&nbsp;&nbsp;del&nbsp;&nbsp;Artículo10,&nbsp;Literal&nbsp;&nbsp;a)&nbsp;y&nbsp;Artículo&nbsp;15&nbsp;del&nbsp;&nbsp;Decreto&nbsp;1279&nbsp;&nbsp;de2002:&nbsp;“Con&nbsp;excepción&nbsp;de&nbsp;los&nbsp;artículos&nbsp;publicados&nbsp;&nbsp;en&nbsp;revistas&nbsp;homologadas&nbsp;o&nbsp;indexadas&nbsp;en&nbsp;la&nbsp;lista&nbsp;de&nbsp;Colciencias,&nbsp;que&nbsp;reciben&nbsp;los&nbsp;puntos&nbsp;...”</td><td data-row="2" class="ql-align-justify"></td><td data-row="2" class="ql-align-justify">Los&nbsp;artículos&nbsp;objeto&nbsp;de&nbsp;la&nbsp;solicitud&nbsp;de&nbsp;reconocimiento&nbsp;son&nbsp;los&nbsp;siguientes:</td><td data-row="2"></td></tr><tr><td data-row="1">Artículo(s)</td><td data-row="1">Solicitante(s)&nbsp;y&nbsp;coautores</td><td data-row="1">No.&nbsp;&nbsp;de&nbsp;autores</td><td data-row="1"></td><td data-row="1">Revista(s)</td><td data-row="1">Puntos&nbsp;sugeridos</td></tr><tr><td data-row="2">Mitigación&nbsp;de&nbsp;la&nbsp;interferencia&nbsp;inter-celda&nbsp;con&nbsp;técnicas&nbsp;de&nbsp;reuso&nbsp;de&nbsp;frecuencia&nbsp;en&nbsp;un&nbsp;sistema&nbsp;LTE</td><td data-row="2">Víctor&nbsp;M.&nbsp;Quintero&nbsp;(Coautores:&nbsp;M.Silva,&nbsp;V.Moreno,&nbsp;C.Hernández)</td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center">4</td><td data-row="2">Pp&nbsp;31-39&nbsp;Full&nbsp;paper</td><td data-row="2"></td><td data-row="2">Revista&nbsp;Gerencia&nbsp;Tecnológica&nbsp;Informática,&nbsp;ISSN&nbsp;1657-8236,&nbsp;Vol.15,&nbsp;No.42,&nbsp;Mayo-Agosto&nbsp;2016,&nbsp;indexada&nbsp;en&nbsp;categoría&nbsp;B</td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center">4</td></tr><tr><td data-row="3">Control&nbsp;de&nbsp;potencia&nbsp;basado&nbsp;en&nbsp;teoría&nbsp;de&nbsp;juegos&nbsp;en&nbsp;sistemas&nbsp;de&nbsp;comunicaciones&nbsp;inalámbricas</td><td data-row="3">Víctor&nbsp;M.&nbsp;Quintero&nbsp;(Coautores:&nbsp;V.Miramá)</td><td data-row="3" class="ql-align-center"></td><td data-row="3" class="ql-align-center"></td><td data-row="3" class="ql-align-center">2</td><td data-row="3">Pp&nbsp;69-78&nbsp;Full&nbsp;paper</td><td data-row="3" class="ql-align-center"></td><td data-row="3" class="ql-align-center"></td><td data-row="3" class="ql-align-center">8</td></tr><tr><td data-row="4">Modelado&nbsp;y&nbsp;simulación&nbsp;de&nbsp;planificadores&nbsp;de&nbsp;recursos&nbsp;radio&nbsp;para&nbsp;una&nbsp;red&nbsp;LTE</td><td data-row="4">Víctor&nbsp;M.&nbsp;Quintero&nbsp;(Coautores:&nbsp;C.Hernández,&nbsp;D.Giraldo,&nbsp;D.Uribe)</td><td data-row="4" class="ql-align-center"></td><td data-row="4" class="ql-align-center"></td><td data-row="4" class="ql-align-center">4</td><td data-row="4">Pp&nbsp;230-245&nbsp;Full&nbsp;paper</td><td data-row="4">Revista&nbsp;Entramado,&nbsp;ISSN&nbsp;1900-3803,&nbsp;Vol.12,&nbsp;No.2,&nbsp;Julio-Diciembre&nbsp;de&nbsp;2016,&nbsp;categoría&nbsp;B</td><td data-row="4"></td><td data-row="4" class="ql-align-center"></td><td data-row="4" class="ql-align-center"></td><td data-row="4" class="ql-align-center">4</td></tr><tr><td data-row="2" class="ql-align-justify"></td></tr><tr><td data-row="7" class="ql-align-center">3</td><td data-row="7">Después&nbsp;de&nbsp;revisar&nbsp;la&nbsp;solicitud&nbsp;de&nbsp;reconocimiento&nbsp;de&nbsp;puntos&nbsp;salariales&nbsp;presentada&nbsp;por&nbsp;el&nbsp;profesor&nbsp;Oscar&nbsp;Andres&nbsp;Vivas&nbsp;Alban,&nbsp;por&nbsp;la&nbsp;publicación&nbsp;del&nbsp;artículo&nbsp;relacionado&nbsp;a&nbsp;continuación,&nbsp;el&nbsp;CPD&nbsp;decidió&nbsp;recomendar&nbsp;su&nbsp;reconocimiento&nbsp;al&nbsp;tenor&nbsp;&nbsp;del&nbsp;&nbsp;Artículo10,&nbsp;Literal&nbsp;&nbsp;a)&nbsp;y&nbsp;Artículo&nbsp;15&nbsp;del&nbsp;&nbsp;Decreto&nbsp;1279&nbsp;&nbsp;de2002:&nbsp;“Con&nbsp;excepción&nbsp;de&nbsp;los&nbsp;artículos&nbsp;publicados&nbsp;&nbsp;en&nbsp;revistas&nbsp;homologadas&nbsp;o&nbsp;indexadas&nbsp;en&nbsp;la&nbsp;lista&nbsp;de&nbsp;Colciencias,&nbsp;que&nbsp;reciben&nbsp;los&nbsp;puntos&nbsp;...”</td><td data-row="7"></td><td data-row="7">El&nbsp;&nbsp;artículo&nbsp;objeto&nbsp;de&nbsp;la&nbsp;solicitud&nbsp;de&nbsp;reconocimiento&nbsp;es&nbsp;el&nbsp;siguiente:</td><td data-row="7"></td></tr><tr><td data-row="1">Artículo(s)</td><td data-row="1">Solicitante(s)&nbsp;y&nbsp;coautores</td><td data-row="1">No.&nbsp;&nbsp;de&nbsp;autores</td><td data-row="1"></td><td data-row="1">Revista(s)</td><td data-row="1">Puntos&nbsp;sugeridos</td></tr><tr><td data-row="2">Robótica&nbsp;quirúrgica,&nbsp;desde&nbsp;los&nbsp;grandes&nbsp;asistentes&nbsp;hasta&nbsp;la&nbsp;nanotecnología</td><td data-row="2">Oscar&nbsp;A.&nbsp;Vivas</td><td data-row="2">(Coautores:&nbsp;K.Correa,&nbsp;J.&nbsp;Sabater)</td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center">2</td><td data-row="2">Pp&nbsp;182-190&nbsp;Full&nbsp;paper</td><td data-row="2">Revista&nbsp;Scientia&nbsp;et&nbsp;Technica&nbsp;–&nbsp;Universidad&nbsp;Tecnológica&nbsp;de&nbsp;Pereira,&nbsp;Vol.21,&nbsp;No.2,&nbsp;Junio&nbsp;2016,&nbsp;ISSN:0122-1701</td><td data-row="2">Categoría&nbsp;C</td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center">3</td></tr><tr><td data-row="7" class="ql-align-justify"></td></tr><tr><td data-row="10" class="ql-align-center">4</td><td data-row="10" class="ql-align-justify">Después&nbsp;de&nbsp;revisar&nbsp;la&nbsp;solicitud&nbsp;de&nbsp;reconocimiento&nbsp;de&nbsp;puntos&nbsp;salariales&nbsp;presentada&nbsp;por&nbsp;la&nbsp;profesora&nbsp;Sandra&nbsp;Milena&nbsp;Roa&nbsp;Martínez,&nbsp;por&nbsp;la&nbsp;publicación&nbsp;del&nbsp;artículo&nbsp;relacionado&nbsp;a&nbsp;continuación,&nbsp;el&nbsp;CPD&nbsp;decidió&nbsp;recomendar&nbsp;su&nbsp;reconocimiento&nbsp;al&nbsp;tenor&nbsp;&nbsp;delArtículo&nbsp;&nbsp;10,&nbsp;Literal&nbsp;&nbsp;a)&nbsp;y&nbsp;Artículo&nbsp;15&nbsp;del&nbsp;&nbsp;Decreto&nbsp;1279&nbsp;&nbsp;de2002:&nbsp;“Con&nbsp;excepción&nbsp;de&nbsp;los&nbsp;artículos&nbsp;publicados&nbsp;&nbsp;en&nbsp;revistas&nbsp;homologadas&nbsp;o&nbsp;indexadas&nbsp;en&nbsp;la&nbsp;lista&nbsp;de&nbsp;Colciencias,&nbsp;que&nbsp;reciben&nbsp;los&nbsp;puntos&nbsp;...”</td><td data-row="10" class="ql-align-justify"></td><td data-row="10">El&nbsp;&nbsp;artículo&nbsp;objeto&nbsp;de&nbsp;la&nbsp;solicitud&nbsp;de&nbsp;reconocimiento&nbsp;es&nbsp;el&nbsp;siguiente:</td><td data-row="10"></td></tr><tr><td data-row="1">Artículo(s)</td><td data-row="1">Solicitante(s)&nbsp;y&nbsp;coautores</td><td data-row="1">No.&nbsp;&nbsp;de&nbsp;autores</td><td data-row="1"></td><td data-row="1">Revista(s)</td><td data-row="1">Puntos&nbsp;sugeridos</td></tr><tr><td data-row="2">Caracterización&nbsp;de&nbsp;los&nbsp;hábitos&nbsp;en&nbsp;el&nbsp;uso&nbsp;de&nbsp;tic&nbsp;de&nbsp;los&nbsp;estudiantes&nbsp;del&nbsp;departamento&nbsp;de&nbsp;morfología&nbsp;de&nbsp;la&nbsp;Universidad&nbsp;del&nbsp;Cauca</td><td data-row="2">Sandra&nbsp;M.Roa</td><td data-row="2">(Coautores:&nbsp;A.Ruiz,&nbsp;J.&nbsp;Vasquez)</td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center">3</td><td data-row="2">Pp&nbsp;viii&nbsp;-&nbsp;ix&nbsp;Artículo&nbsp;corto</td><td data-row="2">Revista&nbsp;Médica&nbsp;de&nbsp;Risaralda,&nbsp;ISSN:&nbsp;0122-0667,&nbsp;Vol.&nbsp;19&nbsp;Sup.&nbsp;2&nbsp;Año&nbsp;2013,&nbsp;indexada&nbsp;en&nbsp;categoría&nbsp;B.</td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center"></td><td data-row="2" class="ql-align-center">4,8</td><td data-row="2"></td></tr><tr><td data-row="10"></td><td data-row="10" class="ql-align-justify">El&nbsp;Comité&nbsp;sugiere&nbsp;asignar&nbsp;el&nbsp;reconocimiento&nbsp;los&nbsp;puntos&nbsp;indicados&nbsp;por&nbsp;la&nbsp;publicación&nbsp;del&nbsp;artículo&nbsp;relacionado,&nbsp;acorde&nbsp;con&nbsp;lo&nbsp;establecido&nbsp;en&nbsp;el&nbsp;Artículo&nbsp;10,&nbsp;Capítulos&nbsp;I&nbsp;y&nbsp;III&nbsp;del&nbsp;Decreto&nbsp;1279&nbsp;de&nbsp;2002&nbsp;-&nbsp;B.&nbsp;<em>“Otras&nbsp;modalidades&nbsp;de&nbsp;publicaciones&nbsp;en&nbsp;revistas&nbsp;especializadas.&nbsp;Para&nbsp;la&nbsp;denominada&nbsp;“Comunicación&nbsp;corta”&nbsp;(“short&nbsp;comunication”,&nbsp;“artículo&nbsp;corto”),&nbsp;según&nbsp;los&nbsp;parámetros&nbsp;de&nbsp;COLCIENCIAS,&nbsp;publicada&nbsp;en&nbsp;revistas&nbsp;especializadas&nbsp;indexadas&nbsp;u&nbsp;homologadas&nbsp;por&nbsp;COLCIENCIAS,&nbsp;se&nbsp;asigna&nbsp;el&nbsp;60%&nbsp;del&nbsp;puntaje&nbsp;que&nbsp;le&nbsp;corresponde&nbsp;según&nbsp;su&nbsp;nivel&nbsp;y&nbsp;clasificación”</em>.</td><td data-row="10" class="ql-align-justify"></td></tr></tbody></table><p></p>
    `;
  }


  modalConfirmationExportCetificate() {

    console.log("text: ", this.text);

    this.confirmationService.confirm({
      target: 'body' as unknown as EventTarget,
      message: '¿Está seguro(a) de exportar la acta?',
      header: 'Confirmación',
      closable: true,
      closeOnEscape: true,
      icon: 'pi pi-info-circle',
      rejectButtonProps: {
        label: 'Cancelar',
        severity: 'secondary',
        outlined: true,

      },
      acceptButtonProps: {
        label: 'Aceptar',
      },
      accept: async () => {
        this.sendNotification();
      },
    });

  }

  sendNotification() {
    // Lógica para enviar la notificación
    this.messageService.add({ severity: 'success', summary: 'Notifación enviada', detail: 'Notificación enviada exitosamente.' });
  }

}
